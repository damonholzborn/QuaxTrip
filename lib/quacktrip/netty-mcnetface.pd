#N canvas 0 88 1287 443 12;
#X declare -path lib/quacktrip~ -path lib;
#N canvas 192 68 966 615 main-panel 0;
#X text 111 243 server;
#X symbolatom 113 264 32 0 0 0 - #0-server-set #0-server;
#X obj 108 105 tgl 15 0 \$0-onoff \$0-onoff-set empty 17 7 0 10 -262144
-1 -1 0 1;
#X text 127 103 ON/OFF;
#X obj 177 185 vradio 15 1 0 3 \$0-blksel \$0-blksel-set empty 0 -8
0 10 -262144 -1 -1 0;
#X text 196 181 64;
#X text 194 198 128;
#X text 195 212 256;
#X obj 130 182 vradio 15 1 0 3 \$0-nchan \$0-nchan-set empty 0 -8 0
10 -262144 -1 -1 1;
#X text 147 179 0;
#X text 148 194 1;
#X text 148 209 2;
#X text 124 161 chnls;
#X text 174 152 block size, f 5;
#X obj 229 213 tgl 15 0 \$0-2x \$0-2x-set empty 17 7 0 10 -262144 -1
-1 0 1;
#X text 226 192 2X;
#X floatatom 151 290 6 1000 100000 0 - #0-port-set #0-port;
#X text 114 290 port;
#X floatatom 301 289 2 1 8 0 - #0-this-caller-set #0-this-caller;
#X obj 523 25 declare -path lib/quacktrip~ -path lib;
#X obj 452 96 setctl \$0-onoff;
#X obj 450 121 setctl \$0-server;
#X obj 447 222 setctl \$0-blksel;
#X obj 447 200 setctl \$0-nchan;
#X obj 446 246 setctl \$0-2x;
#X text 214 289 this caller;
#X floatatom 253 163 3 0 100 0 - #0-lvl-set #0-lvl;
#X obj 253 184 bng 15 250 50 0 \$0-mute \$0-mute-set empty 0 0 0 12
-262144 -1 -1;
#X obj 327 148 vu 8 80 \$0-vu1 empty -1 -8 0 10 -66577 -1 0 0;
#X text 272 181 mute;
#X obj 339 148 vu 8 80 \$0-vu2 empty -1 -8 0 10 -66577 -1 0 0;
#X obj 254 213 tgl 15 0 \$0-test empty empty 17 7 0 10 -262144 -1 -1
0 1;
#X text 270 211 test;
#X text 279 163 level;
#N canvas 458 86 681 644 input-audio 0;
#X obj 489 257 t b;
#X obj 489 204 f;
#X obj 489 282 f;
#X msg 603 281 0;
#X obj 489 234 moses 1;
#X obj 603 253 t b f;
#X obj 569 214 moses 1;
#X msg 394 166 \; pd dsp 1;
#X obj 9 89 hip~ 3;
#X obj 481 16 r \$0-lvl;
#X msg 481 41 set \$1;
#X obj 481 66 s \$0-lvl-set;
#X obj 331 49 r \$0-lvl;
#X obj 331 81 f;
#X obj 568 185 r \$0-lvl;
#X obj 489 308 s \$0-lvl;
#X obj 489 177 r \$0-mute;
#X obj 331 106 max 0;
#X text 509 145 MUTE logic;
#X obj 323 210 line~;
#X obj 323 170 pack 0 30, f 5;
#X obj 8 247 *~;
#X obj 199 366 abs~;
#X obj 199 391 slop~ 0 0 0.3 0 1e+09;
#X obj 535 395 metro 100;
#X obj 196 429 snapshot~;
#X obj 196 454 rmstodb;
#X obj 196 479 moses 1;
#X msg 197 514 -100;
#X obj 244 509 - 88;
#X obj 113 250 *~;
#X obj 536 367 loadbang;
#X obj 364 364 abs~;
#X obj 364 389 slop~ 0 0 0.3 0 1e+09;
#X obj 361 427 snapshot~;
#X obj 361 452 rmstodb;
#X obj 361 477 moses 1;
#X msg 362 512 -100;
#X obj 409 507 - 88;
#X obj 195 550 s \$0-vu1;
#X obj 360 548 s \$0-vu2;
#X obj 303 134 expr pow($f1*0.02 \, 4);
#X obj 44 376 outlet~;
#X obj 108 378 outlet~;
#X obj 53 117 osc~ 660;
#X obj 35 171 -~;
#X obj 35 215 *~ 0;
#X obj 9 65 adc~ 1;
#X obj 112 84 hip~ 3;
#X obj 138 166 -~;
#X obj 138 210 *~ 0;
#X obj 198 178 r \$0-test;
#X obj 112 60 adc~ 2;
#X obj 53 142 *~ 0.03;
#X obj 167 139 *~ 0.03;
#X obj 166 114 osc~ 880;
#X connect 0 0 2 0;
#X connect 1 0 4 0;
#X connect 2 0 15 0;
#X connect 3 0 15 0;
#X connect 4 0 0 0;
#X connect 4 1 5 0;
#X connect 5 0 3 0;
#X connect 6 1 2 1;
#X connect 8 0 21 0;
#X connect 8 0 45 1;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 12 0 13 0;
#X connect 13 0 17 0;
#X connect 14 0 1 1;
#X connect 14 0 6 0;
#X connect 16 0 1 0;
#X connect 17 0 41 0;
#X connect 19 0 21 1;
#X connect 19 0 30 1;
#X connect 20 0 19 0;
#X connect 21 0 42 0;
#X connect 21 0 22 0;
#X connect 22 0 23 0;
#X connect 23 0 25 0;
#X connect 24 0 25 0;
#X connect 24 0 34 0;
#X connect 25 0 26 0;
#X connect 26 0 27 0;
#X connect 27 0 28 0;
#X connect 27 1 29 0;
#X connect 28 0 39 0;
#X connect 29 0 39 0;
#X connect 30 0 43 0;
#X connect 30 0 32 0;
#X connect 31 0 24 0;
#X connect 32 0 33 0;
#X connect 33 0 34 0;
#X connect 34 0 35 0;
#X connect 35 0 36 0;
#X connect 36 0 37 0;
#X connect 36 1 38 0;
#X connect 37 0 40 0;
#X connect 38 0 40 0;
#X connect 41 0 20 0;
#X connect 41 0 7 0;
#X connect 44 0 53 0;
#X connect 45 0 46 0;
#X connect 46 0 21 0;
#X connect 47 0 8 0;
#X connect 48 0 49 1;
#X connect 48 0 30 0;
#X connect 49 0 50 0;
#X connect 50 0 30 0;
#X connect 51 0 50 1;
#X connect 51 0 46 1;
#X connect 52 0 48 0;
#X connect 53 0 45 0;
#X connect 54 0 49 0;
#X connect 55 0 54 0;
#X restore 438 283 pd input-audio;
#X obj 451 146 setctl \$0-port;
#X obj 448 336 quacktrip~;
#N canvas 420 73 668 550 to-quacktrip 0;
#X obj 20 512 outlet;
#X obj 134 371 sel 1 0;
#X msg 153 435 off;
#X obj 466 407 r \$0-fifo-size;
#X msg 466 436 nbuf \$1;
#X msg 188 437 block \$1;
#X msg 282 439 nchan \$1;
#X obj 188 407 r \$0-block;
#X obj 134 344 r \$0-onoff;
#X obj 282 409 r \$0-nchan;
#X msg 379 438 repeat \$1;
#X obj 377 410 r \$0-2x;
#X msg 34 432 client \$2 \$3;
#X obj 79 167 r \$0-server;
#X obj 37 400 pack 0 s 0;
#X obj 120 198 r \$0-port;
#X obj 138 229 r \$0-this-caller;
#X obj 137 255 t b f;
#X obj 111 291 +;
#X floatatom 123 316 6 0 0 0 - - -;
#X connect 1 0 14 0;
#X connect 1 1 2 0;
#X connect 2 0 0 0;
#X connect 3 0 4 0;
#X connect 4 0 0 0;
#X connect 5 0 0 0;
#X connect 6 0 0 0;
#X connect 7 0 5 0;
#X connect 8 0 1 0;
#X connect 9 0 6 0;
#X connect 10 0 0 0;
#X connect 11 0 10 0;
#X connect 12 0 0 0;
#X connect 13 0 14 1;
#X connect 14 0 12 0;
#X connect 15 0 18 0;
#X connect 16 0 17 0;
#X connect 17 0 18 0;
#X connect 17 1 18 1;
#X connect 18 0 14 2;
#X connect 18 0 19 0;
#X restore 548 302 pd to-quacktrip;
#X obj 494 449 loadbang;
#X obj 428 449 f \$0;
#X obj 471 451 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 451 171 setctl \$0-this-caller;
#X floatatom 137 416 5 0 0 0 - #0-local-sr-set #0-local-sr;
#X floatatom 199 416 3 0 0 0 - #0-local-ch-set #0-local-ch;
#X floatatom 250 416 3 0 0 0 - #0-local-blk-set #0-local-blk;
#X text 106 415 out;
#X text 134 382 sample rate, f 6;
#X text 244 383 block size, f 5;
#X text 182 395 channels;
#X floatatom 297 416 5 0 0 0 - #0-local-mbits-set #0-local-mbits;
#X text 291 380 mbits per sec, f 7;
#X obj 674 229 samplerate~;
#X obj 674 254 s \$0-local-sr-set;
#X obj 683 308 s \$0-local-ch-set;
#X obj 672 68 r \$0-blksel;
#X obj 672 93 sel 0 1;
#X msg 672 118 64;
#X msg 702 118 128;
#X msg 732 118 256;
#X obj 672 143 s \$0-block;
#X obj 674 176 loadbang;
#X obj 674 201 metro 1000;
#X obj 682 283 r \$0-nchan;
#X obj 778 73 r \$0-block;
#X obj 779 99 s \$0-local-blk-set;
#X obj 462 377 route got-packet drop late miss request-call no-peer-yet
running bw, f 68;
#X obj 733 406 unpack;
#X obj 774 451 s \$0-local-mbits-set;
#X obj 733 491 s \$0-remote-mbits-set;
#X floatatom 444 481 5 0 0 0 - - -;
#X obj 553 335 print to-q;
#X text 158 127 --- AUDIO TO SEND ---;
#X text 128 329 ------- readouts --------;
#X msg 424 506 \; \$1-server symbol localhost \; \$1-port 10000 \;
\$1-this-caller 1 \; \$1-nchan 1 \; \$1-block 64;
#X connect 34 0 36 0;
#X connect 34 1 36 1;
#X connect 36 2 65 0;
#X connect 37 0 36 2;
#X connect 38 0 40 0;
#X connect 39 0 73 0;
#X connect 39 0 69 0;
#X connect 40 0 39 0;
#X connect 51 0 52 0;
#X connect 54 0 55 0;
#X connect 55 0 56 0;
#X connect 55 1 57 0;
#X connect 55 2 58 0;
#X connect 56 0 59 0;
#X connect 57 0 59 0;
#X connect 58 0 59 0;
#X connect 60 0 61 0;
#X connect 61 0 51 0;
#X connect 62 0 53 0;
#X connect 63 0 64 0;
#X connect 65 7 66 0;
#X connect 66 0 68 0;
#X connect 66 1 67 0;
#X coords 0 -1 1 1 260 350 2 100 100;
#X restore 1010 17 pd main-panel;
#X obj 9 16 receiver \$0 1;
#X obj 134 16 receiver \$0 2;
#X obj 259 16 receiver \$0 3;
#X obj 384 16 receiver \$0 4;
#X obj 509 16 receiver \$0 5;
#X obj 634 16 receiver \$0 6;
#X obj 759 16 receiver \$0 7;
#X obj 884 16 receiver \$0 8;
#N canvas 335 289 962 566 README 0;
#X text 24 49 This patch allows up to eight participants to share audio
in real time through a repeater that should be run on a publicly-accessible
server. (The server should run the patch named "netty-mcserver" \,
which can be invoked remotely with the command "[path]/pd -nosound
-nogui -nrt netty-mcserver.pd" \, and should have UDP ports 10000-10100
open assuming the base port number is 10000). Each group of up to 8
callers requires its own instance of the server.;
#X text 20 186 Each caller gives him/herself a number from 1 to 8 that
determines which channel they will show up at on everyone's copy of
the patch (including their own). Make sure no two callers are trying
to use the same channel. Also decide on a sample rate everyone will
use (set in Pd's audio settings dialogs).;
#X text 492 250 VU meters on both inputs and outputs are post-fader.
They clip at the top (not at the first red LED).;
#X obj 491 446 f \$0;
#X obj 493 423 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X msg 490 472 \; \$1-server symbol localhost \; \$1-this-caller 1
;
#X obj 718 444 f \$0;
#X obj 720 420 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X msg 717 470 \; \$1-server symbol localhost \; \$1-this-caller 2
;
#X text 99 21 netty mcnetface (8/2020);
#X text 491 130 You can change the FIFO size individually on all the
channels you're listening to. Typical values range from 20 to 50...
the size is in units of 64-sample blocks (1.45 or 1.33 millseconds
at 44100 or 48000 sample rate).;
#X text 490 198 Each mixer channel can be set to mono (to pan a mono
signal to both output channels) or stereo. The two outputs may be sent
to individually chosen audio outputs.;
#X text 20 287 Once the server is running \, callers may join and leave
the call at will using the ON/OFF control. Before starting a call \,
set the host address \, the base port number (if it's different from
10000) and their channel ("this caller" \, from 1 to 8). Other controls
in the right hand side of the patch are for sending audio (number of
channels \, block size \, "2x" to repeat each sent packet twice \,
level (from 0 to 100 with 50 for unit gain) and "test" to send a tone
instead of your audio input.;
#X text 20 427 At bottom right you can see statistics about what you
are sending. These are readouts only. (To change cample rate \, go
to Pd's audio settings panel \, not this patch.);
#X text 494 41 The eight mixer channels control how (and whether) you
will hear yourself and the other participants. You will appear on the
channel you selected when making the call. You can quickly test audio
by turning on the test tone at right and turning your own input channel
up.;
#X text 482 361 These two buttons are for testing - they place calls
to a netty-mcserver on this same machine - run all three patches at
once \, preferably on separate copies of Pd:;
#X connect 3 0 5 0;
#X connect 4 0 3 0;
#X connect 6 0 8 0;
#X connect 7 0 6 0;
#X restore 1134 377 pd README;
#X text 1021 402 Netty mcnetface \, version 0.6;
#X text 1024 377 directions ->>;
